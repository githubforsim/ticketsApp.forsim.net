<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TicketsApp: Référence de la classe AdminModel</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TicketsApp<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Fonctions membres publiques</a> &#124;
<a href="#pri-attribs">Attributs privés</a> &#124;
<a href="class_admin_model-members.html">Liste de tous les membres</a>  </div>
  <div class="headertitle"><div class="title">Référence de la classe AdminModel</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Fonctions membres publiques</h2></td></tr>
<tr class="memitem:a18105909e60620ca7c61001ef7acedb9" id="r_a18105909e60620ca7c61001ef7acedb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18105909e60620ca7c61001ef7acedb9">__construct</a> (PDO $db)</td></tr>
<tr class="separator:a18105909e60620ca7c61001ef7acedb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c337589f08244481d27416e715887d" id="r_a61c337589f08244481d27416e715887d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61c337589f08244481d27416e715887d">createUser</a> ($username, $mail, $entreprise, $hashedPassword, $role)</td></tr>
<tr class="separator:a61c337589f08244481d27416e715887d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83ba6b65740e0bf4813b18743830e44" id="r_af83ba6b65740e0bf4813b18743830e44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af83ba6b65740e0bf4813b18743830e44">addProduitUser</a> ($username, $selectedProducts)</td></tr>
<tr class="separator:af83ba6b65740e0bf4813b18743830e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84051a3ee1baac9e884ec0da3b3406b" id="r_ac84051a3ee1baac9e884ec0da3b3406b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac84051a3ee1baac9e884ec0da3b3406b">isUsernameExists</a> ($username)</td></tr>
<tr class="separator:ac84051a3ee1baac9e884ec0da3b3406b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb692dfbea0cc49a0177dc7f5763f7c4" id="r_adb692dfbea0cc49a0177dc7f5763f7c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb692dfbea0cc49a0177dc7f5763f7c4">logEvent</a> ($ticket_id, $username, $statut_evenement_id)</td></tr>
<tr class="separator:adb692dfbea0cc49a0177dc7f5763f7c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0865960423f2dea5bc888bc19cd10adc" id="r_a0865960423f2dea5bc888bc19cd10adc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0865960423f2dea5bc888bc19cd10adc">createTicket</a> ($titre, $description, $date_creation, $statut_id, $urgence_id, $username, $produit_id, $type_id, $filesData=null)</td></tr>
<tr class="separator:a0865960423f2dea5bc888bc19cd10adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a13082dbb4314461520699e6ad2d4a3" id="r_a4a13082dbb4314461520699e6ad2d4a3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a13082dbb4314461520699e6ad2d4a3">createTicketSave</a> ($ticketId, $titre, $description, $date_creation, $statut_id, $urgence_id, $username, $produit_id, $type_id)</td></tr>
<tr class="separator:a4a13082dbb4314461520699e6ad2d4a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae905ca8c7cc680282c3841421524c501" id="r_ae905ca8c7cc680282c3841421524c501"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae905ca8c7cc680282c3841421524c501">addAttachment</a> ($ticketId, $filename)</td></tr>
<tr class="separator:ae905ca8c7cc680282c3841421524c501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc61b0cc2832c280f59bfb22dddadd3" id="r_abfc61b0cc2832c280f59bfb22dddadd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abfc61b0cc2832c280f59bfb22dddadd3">getAllEventHistory</a> ($produit_id)</td></tr>
<tr class="separator:abfc61b0cc2832c280f59bfb22dddadd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e08984cf490ae1a9f5d7f6a73c8676" id="r_a82e08984cf490ae1a9f5d7f6a73c8676"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82e08984cf490ae1a9f5d7f6a73c8676">getTicketEventHistory</a> ($ticket_id)</td></tr>
<tr class="separator:a82e08984cf490ae1a9f5d7f6a73c8676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50416f20350d353ca7cfc5253241af5d" id="r_a50416f20350d353ca7cfc5253241af5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50416f20350d353ca7cfc5253241af5d">getAllOpenTickets</a> ($produit_id)</td></tr>
<tr class="separator:a50416f20350d353ca7cfc5253241af5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45aa3d4d4c826cc295ac0848d76f433b" id="r_a45aa3d4d4c826cc295ac0848d76f433b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45aa3d4d4c826cc295ac0848d76f433b">getAllSolvedTickets</a> ($produit_id)</td></tr>
<tr class="separator:a45aa3d4d4c826cc295ac0848d76f433b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae708caac064d4ca3744612ab23fde1df" id="r_ae708caac064d4ca3744612ab23fde1df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae708caac064d4ca3744612ab23fde1df">getAllClosedTickets</a> ($produit_id)</td></tr>
<tr class="separator:ae708caac064d4ca3744612ab23fde1df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f358a3ea6c7bdac1fc362b2e0abd88" id="r_a93f358a3ea6c7bdac1fc362b2e0abd88"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93f358a3ea6c7bdac1fc362b2e0abd88">getAttachmentsTicket</a> ($ticket_id)</td></tr>
<tr class="separator:a93f358a3ea6c7bdac1fc362b2e0abd88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad281715b03529e0022eb36116ef40573" id="r_ad281715b03529e0022eb36116ef40573"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad281715b03529e0022eb36116ef40573">getTicketDetails</a> ($ticket_id)</td></tr>
<tr class="separator:ad281715b03529e0022eb36116ef40573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad868ab9678c691322094bd2f9e5a1965" id="r_ad868ab9678c691322094bd2f9e5a1965"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad868ab9678c691322094bd2f9e5a1965">getTicketSaveDetails</a> ($ticket_id)</td></tr>
<tr class="separator:ad868ab9678c691322094bd2f9e5a1965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb9e6e43abdf48d4575a7fbc2a3e5412" id="r_adb9e6e43abdf48d4575a7fbc2a3e5412"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb9e6e43abdf48d4575a7fbc2a3e5412">getClosedDetails</a> ($ticket_id)</td></tr>
<tr class="separator:adb9e6e43abdf48d4575a7fbc2a3e5412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fdbf5b91a654a26d187428af65e6f63" id="r_a1fdbf5b91a654a26d187428af65e6f63"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1fdbf5b91a654a26d187428af65e6f63">getSolvedDetails</a> ($ticket_id)</td></tr>
<tr class="separator:a1fdbf5b91a654a26d187428af65e6f63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20581b515b9f9499e3d000591ce011a1" id="r_a20581b515b9f9499e3d000591ce011a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20581b515b9f9499e3d000591ce011a1">getUsers</a> ()</td></tr>
<tr class="separator:a20581b515b9f9499e3d000591ce011a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6715babb8accb268587092ce1927649" id="r_ae6715babb8accb268587092ce1927649"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6715babb8accb268587092ce1927649">getProduit</a> ()</td></tr>
<tr class="separator:ae6715babb8accb268587092ce1927649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e1a3b63fb4dc2dd6e4c2f62f63ccee" id="r_a17e1a3b63fb4dc2dd6e4c2f62f63ccee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17e1a3b63fb4dc2dd6e4c2f62f63ccee">getAllTicketMessages</a> ($ticket_id, $username)</td></tr>
<tr class="separator:a17e1a3b63fb4dc2dd6e4c2f62f63ccee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e0958674a1084a1a6922fa7b2cf88c" id="r_ac2e0958674a1084a1a6922fa7b2cf88c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2e0958674a1084a1a6922fa7b2cf88c">sendMessage</a> ($ticket_id, $message, $username)</td></tr>
<tr class="separator:ac2e0958674a1084a1a6922fa7b2cf88c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5775e2b900e95eae8f702307cffb2bbb" id="r_a5775e2b900e95eae8f702307cffb2bbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5775e2b900e95eae8f702307cffb2bbb">updateTicketsDetails</a> ($ticket_id, $newTitle, $newDescription)</td></tr>
<tr class="separator:a5775e2b900e95eae8f702307cffb2bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e7e7ea7e913a0f9f85e7b0ea68aff4" id="r_ac6e7e7ea7e913a0f9f85e7b0ea68aff4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6e7e7ea7e913a0f9f85e7b0ea68aff4">getUserByUsername</a> ($username)</td></tr>
<tr class="separator:ac6e7e7ea7e913a0f9f85e7b0ea68aff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66d28939888da0e528bcc66d5e43391" id="r_ac66d28939888da0e528bcc66d5e43391"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac66d28939888da0e528bcc66d5e43391">updateUserPassword</a> ($username, $newPassword)</td></tr>
<tr class="separator:ac66d28939888da0e528bcc66d5e43391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e14ed0dd4d0672824840ab0f7188c9d" id="r_a1e14ed0dd4d0672824840ab0f7188c9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e14ed0dd4d0672824840ab0f7188c9d">getProduitsByUser</a> ($username)</td></tr>
<tr class="separator:a1e14ed0dd4d0672824840ab0f7188c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded5ff5d0e12ebd38ce7f4ccac73f903" id="r_aded5ff5d0e12ebd38ce7f4ccac73f903"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aded5ff5d0e12ebd38ce7f4ccac73f903">getUserMail</a> ($username)</td></tr>
<tr class="separator:aded5ff5d0e12ebd38ce7f4ccac73f903"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Attributs privés</h2></td></tr>
<tr class="memitem:ab2f29f75e97371fd013eb3ff367a7d4c" id="r_ab2f29f75e97371fd013eb3ff367a7d4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2f29f75e97371fd013eb3ff367a7d4c">$db</a></td></tr>
<tr class="memdesc:ab2f29f75e97371fd013eb3ff367a7d4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Objet PDO pour la connexion à la base de données.  <br /></td></tr>
<tr class="separator:ab2f29f75e97371fd013eb3ff367a7d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description détaillée</h2>
<div class="textblock">
<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00027">27</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
</div><h2 class="groupheader">Documentation des constructeurs et destructeur</h2>
<a id="a18105909e60620ca7c61001ef7acedb9" name="a18105909e60620ca7c61001ef7acedb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18105909e60620ca7c61001ef7acedb9">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::__construct </td>
          <td>(</td>
          <td class="paramtype">PDO</td>          <td class="paramname"><span class="paramname"><em>$db</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00036">36</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>    {</div>
<div class="line"><span class="lineno">   38</span>        $this-&gt;db = <a class="code hl_variable" href="#ab2f29f75e97371fd013eb3ff367a7d4c">$db</a>;</div>
<div class="line"><span class="lineno">   39</span>    }</div>
<div class="ttc" id="aclass_admin_model_html_ab2f29f75e97371fd013eb3ff367a7d4c"><div class="ttname"><a href="#ab2f29f75e97371fd013eb3ff367a7d4c">AdminModel\$db</a></div><div class="ttdeci">$db</div><div class="ttdoc">Objet PDO pour la connexion à la base de données.</div><div class="ttdef"><b>Definition</b> <a href="_admin_model_8php_source.html#l00029">AdminModel.php:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Documentation des fonctions membres</h2>
<a id="ae905ca8c7cc680282c3841421524c501" name="ae905ca8c7cc680282c3841421524c501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae905ca8c7cc680282c3841421524c501">&#9670;&#160;</a></span>addAttachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::addAttachment </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticketId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$filename</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00247">247</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>    {</div>
<div class="line"><span class="lineno">  249</span>        $query = <span class="stringliteral">&quot;INSERT INTO attachments (ticket_id, filename) VALUES (:ticket_id, :filename)&quot;</span>;</div>
<div class="line"><span class="lineno">  250</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  251</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticketId);</div>
<div class="line"><span class="lineno">  252</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:filename&#39;</span>, $filename);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>        <span class="comment">// Vérification si l&#39;exécution est réussite sinon erreur</span></div>
<div class="line"><span class="lineno">  255</span>        <span class="keywordflow">if</span> ($statement-&gt;execute()) {</div>
<div class="line"><span class="lineno">  256</span>            <span class="comment">// Créer un événement pour l&#39;ajout de la pièce jointe</span></div>
<div class="line"><span class="lineno">  257</span>            $username = $_SESSION[<span class="stringliteral">&#39;username&#39;</span>];</div>
<div class="line"><span class="lineno">  258</span>            $statut_evenement_id = 5; <span class="comment">// 5 = Attachment added</span></div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  261</span>                $this-&gt;<a class="code hl_function" href="#adb692dfbea0cc49a0177dc7f5763f7c4">logEvent</a>($ticketId, $username, $statut_evenement_id);</div>
<div class="line"><span class="lineno">  262</span>            } <span class="keywordflow">catch</span> (Exception $e) {</div>
<div class="line"><span class="lineno">  263</span>                <span class="comment">// Gérer l&#39;exception selon les besoins</span></div>
<div class="line"><span class="lineno">  264</span>                error_log(<span class="stringliteral">&quot;Failed to log event: &quot;</span> . $e-&gt;getMessage());</div>
<div class="line"><span class="lineno">  265</span>            }</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  268</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  269</span>            error_log(<span class="stringliteral">&quot;Failed to execute SQL query: &quot;</span> . $query);</div>
<div class="line"><span class="lineno">  270</span>            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Failed to add attachment to the database.&#39;</span>);</div>
<div class="line"><span class="lineno">  271</span>        }</div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="ttc" id="aclass_admin_model_html_adb692dfbea0cc49a0177dc7f5763f7c4"><div class="ttname"><a href="#adb692dfbea0cc49a0177dc7f5763f7c4">AdminModel\logEvent</a></div><div class="ttdeci">logEvent($ticket_id, $username, $statut_evenement_id)</div><div class="ttdef"><b>Definition</b> <a href="_admin_model_8php_source.html#l00118">AdminModel.php:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af83ba6b65740e0bf4813b18743830e44" name="af83ba6b65740e0bf4813b18743830e44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af83ba6b65740e0bf4813b18743830e44">&#9670;&#160;</a></span>addProduitUser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::addProduitUser </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$selectedProducts</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00079">79</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>    {</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">foreach</span> ($selectedProducts as $produit_id) {</div>
<div class="line"><span class="lineno">   82</span>            $query = <span class="stringliteral">&quot;INSERT INTO user_produit (username, produit_id) VALUES (:username, :produit_id)&quot;</span>;</div>
<div class="line"><span class="lineno">   83</span>            $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">   84</span>            $statement-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">   85</span>            $statement-&gt;bindValue(<span class="stringliteral">&#39;:produit_id&#39;</span>, $produit_id);</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>            <span class="keywordflow">if</span> (!$statement-&gt;execute()) {</div>
<div class="line"><span class="lineno">   88</span>                error_log(<span class="stringliteral">&quot;Failed to execute SQL query: &quot;</span> . $query);</div>
<div class="line"><span class="lineno">   89</span>                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Failed to associate user with products.&#39;</span>);</div>
<div class="line"><span class="lineno">   90</span>            }</div>
<div class="line"><span class="lineno">   91</span>        }</div>
<div class="line"><span class="lineno">   92</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0865960423f2dea5bc888bc19cd10adc" name="a0865960423f2dea5bc888bc19cd10adc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0865960423f2dea5bc888bc19cd10adc">&#9670;&#160;</a></span>createTicket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::createTicket </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$titre</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$description</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$date_creation</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$statut_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$urgence_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$produit_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$type_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$filesData</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00174">174</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  175</span>    {</div>
<div class="line"><span class="lineno">  176</span>        date_default_timezone_set(<span class="stringliteral">&#39;Europe/Paris&#39;</span>);</div>
<div class="line"><span class="lineno">  177</span>        $date_creation = date(<span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span>); <span class="comment">// Utiliser la date et l&#39;heure actuelles</span></div>
<div class="line"><span class="lineno">  178</span>        </div>
<div class="line"><span class="lineno">  179</span>        $query = <span class="stringliteral">&quot;INSERT INTO ticket (titre, description, date_creation, statut_id, urgence_id, username, produit_id, type_id) </span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">                  VALUES (:titre, :description, :date_creation, :statut_id, :urgence_id, :username, :produit_id, :type_id)&quot;</span>;</div>
<div class="line"><span class="lineno">  181</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  182</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:titre&#39;</span>, $titre);</div>
<div class="line"><span class="lineno">  183</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:description&#39;</span>, $description);</div>
<div class="line"><span class="lineno">  184</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:date_creation&#39;</span>, $date_creation);</div>
<div class="line"><span class="lineno">  185</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:statut_id&#39;</span>, $statut_id);</div>
<div class="line"><span class="lineno">  186</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:urgence_id&#39;</span>, $urgence_id);</div>
<div class="line"><span class="lineno">  187</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">  188</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:produit_id&#39;</span>, $produit_id);</div>
<div class="line"><span class="lineno">  189</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:type_id&#39;</span>, $type_id);</div>
<div class="line"><span class="lineno">  190</span>        </div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">if</span> ($statement-&gt;execute()) {</div>
<div class="line"><span class="lineno">  192</span>            $ticketId = $this-&gt;db-&gt;lastInsertId();</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>            <span class="comment">// Sauvegarde des pièces jointes si elles existent</span></div>
<div class="line"><span class="lineno">  195</span>            <span class="keywordflow">if</span> ($filesData) {</div>
<div class="line"><span class="lineno">  196</span>                $this-&gt;createAttachments($ticketId, $filesData, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  197</span>            }</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>            <span class="comment">// Appel de la fonction createTicketSave pour sauvegarder le ticket dans ticket_save</span></div>
<div class="line"><span class="lineno">  200</span>            $this-&gt;<a class="code hl_function" href="#a4a13082dbb4314461520699e6ad2d4a3">createTicketSave</a>($ticketId, $titre, $description, $date_creation, $statut_id, $urgence_id, $username, $produit_id, $type_id);</div>
<div class="line"><span class="lineno">  201</span>            </div>
<div class="line"><span class="lineno">  202</span>            <span class="comment">// Renvoi de l&#39;ID du ticket créé</span></div>
<div class="line"><span class="lineno">  203</span>            <span class="keywordflow">return</span> $ticketId;</div>
<div class="line"><span class="lineno">  204</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  205</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Si échec renvoi false</span></div>
<div class="line"><span class="lineno">  206</span>        }</div>
<div class="line"><span class="lineno">  207</span>    }</div>
<div class="ttc" id="aclass_admin_model_html_a4a13082dbb4314461520699e6ad2d4a3"><div class="ttname"><a href="#a4a13082dbb4314461520699e6ad2d4a3">AdminModel\createTicketSave</a></div><div class="ttdeci">createTicketSave($ticketId, $titre, $description, $date_creation, $statut_id, $urgence_id, $username, $produit_id, $type_id)</div><div class="ttdef"><b>Definition</b> <a href="_admin_model_8php_source.html#l00222">AdminModel.php:222</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a13082dbb4314461520699e6ad2d4a3" name="a4a13082dbb4314461520699e6ad2d4a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a13082dbb4314461520699e6ad2d4a3">&#9670;&#160;</a></span>createTicketSave()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::createTicketSave </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticketId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$titre</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$description</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$date_creation</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$statut_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$urgence_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$produit_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$type_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00222">222</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  223</span>    {</div>
<div class="line"><span class="lineno">  224</span>        $query = <span class="stringliteral">&quot;INSERT INTO ticket_save (ticket_id, titre, description, date_creation, statut_id, urgence_id, username, produit_id, type_id) </span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">                VALUES (:ticket_id, :titre, :description, :date_creation, :statut_id, :urgence_id, :username, :produit_id, :type_id)&quot;</span>;</div>
<div class="line"><span class="lineno">  226</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  227</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticketId);</div>
<div class="line"><span class="lineno">  228</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:titre&#39;</span>, $titre);</div>
<div class="line"><span class="lineno">  229</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:description&#39;</span>, $description);</div>
<div class="line"><span class="lineno">  230</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:date_creation&#39;</span>, $date_creation);</div>
<div class="line"><span class="lineno">  231</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:statut_id&#39;</span>, $statut_id);</div>
<div class="line"><span class="lineno">  232</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:urgence_id&#39;</span>, $urgence_id);</div>
<div class="line"><span class="lineno">  233</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">  234</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:produit_id&#39;</span>, $produit_id);</div>
<div class="line"><span class="lineno">  235</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:type_id&#39;</span>, $type_id);</div>
<div class="line"><span class="lineno">  236</span>        $statement-&gt;execute();</div>
<div class="line"><span class="lineno">  237</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a61c337589f08244481d27416e715887d" name="a61c337589f08244481d27416e715887d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61c337589f08244481d27416e715887d">&#9670;&#160;</a></span>createUser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::createUser </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$mail</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$entreprise</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$hashedPassword</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$role</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00052">52</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>    {</div>
<div class="line"><span class="lineno">   54</span>        $query = <span class="stringliteral">&quot;INSERT INTO user (username, mail, entreprise, pwd, role) VALUES (:username, :mail, :entreprise, :pwd, :role)&quot;</span>;</div>
<div class="line"><span class="lineno">   55</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">   56</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">   57</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:mail&#39;</span>, $mail);</div>
<div class="line"><span class="lineno">   58</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:entreprise&#39;</span>, $entreprise);</div>
<div class="line"><span class="lineno">   59</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:pwd&#39;</span>, $hashedPassword);</div>
<div class="line"><span class="lineno">   60</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:role&#39;</span>, $role);</div>
<div class="line"><span class="lineno">   61</span>        <span class="comment">// Vérification si l&#39;execution est réussite sinon erreur</span></div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">if</span> ($statement-&gt;execute()) {</div>
<div class="line"><span class="lineno">   63</span>            header(<span class="stringliteral">&#39;Location: /ticketsApp/config/routes.php/user_details/&#39;</span> . urlencode($username));</div>
<div class="line"><span class="lineno">   64</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   65</span>        } <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">   66</span>        {</div>
<div class="line"><span class="lineno">   67</span>            error_log(<span class="stringliteral">&quot;Failed to execute SQL query: &quot;</span> . $query);</div>
<div class="line"><span class="lineno">   68</span>            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Failed to add attachment to the database.&#39;</span>);</div>
<div class="line"><span class="lineno">   69</span>        }</div>
<div class="line"><span class="lineno">   70</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae708caac064d4ca3744612ab23fde1df" name="ae708caac064d4ca3744612ab23fde1df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae708caac064d4ca3744612ab23fde1df">&#9670;&#160;</a></span>getAllClosedTickets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getAllClosedTickets </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$produit_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00365">365</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  366</span>    {</div>
<div class="line"><span class="lineno">  367</span>        $query = <span class="stringliteral">&quot;SELECT t.ticket_id, t.titre, DATE_FORMAT(t.date_creation, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_creation, s.valeur, p.nom_produit, ty.nom_type, u.niveau, us.username FROM ticket t</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">        INNER JOIN statut s ON s.statut_id = t.statut_id</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">        INNER JOIN urgence u ON u.urgence_id = t.urgence_id</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">        INNER JOIN user us ON us.username = t.username</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">        INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">        INNER JOIN type ty ON ty.type_id = t.type_id</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">        WHERE s.statut_id = 3 AND  p.produit_id = :produit_id</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">        ORDER BY t.ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  375</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  376</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:produit_id&#39;</span> =&gt; $produit_id]);</div>
<div class="line"><span class="lineno">  377</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  378</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="abfc61b0cc2832c280f59bfb22dddadd3" name="abfc61b0cc2832c280f59bfb22dddadd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfc61b0cc2832c280f59bfb22dddadd3">&#9670;&#160;</a></span>getAllEventHistory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getAllEventHistory </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$produit_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00280">280</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>    {</div>
<div class="line"><span class="lineno">  282</span>        $query = <span class="stringliteral">&quot;SELECT e.evenement_id, e.ticket_id, DATE_FORMAT(e.date_evenement, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_evenement, e.username, se.event_type, e.titre, e.description, p.nom_produit, t.statut_id </span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">                FROM evenement e</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">                INNER JOIN statut_evenement se ON e.statut_evenement_id = se.statut_evenement_id</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">                INNER JOIN ticket t ON e.ticket_id = t.ticket_id</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">                INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">                WHERE p.produit_id = :produit_id</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">                ORDER BY e.date_evenement DESC&quot;</span>;</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  291</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:produit_id&#39;</span> =&gt; $produit_id]);</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  293</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a50416f20350d353ca7cfc5253241af5d" name="a50416f20350d353ca7cfc5253241af5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50416f20350d353ca7cfc5253241af5d">&#9670;&#160;</a></span>getAllOpenTickets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getAllOpenTickets </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$produit_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00322">322</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  323</span>    {</div>
<div class="line"><span class="lineno">  324</span>        $query = <span class="stringliteral">&quot;SELECT t.ticket_id, t.titre, DATE_FORMAT(t.date_creation, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_creation, s.valeur, p.nom_produit, ty.nom_type, u.niveau, us.username FROM ticket t</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        INNER JOIN statut s ON s.statut_id = t.statut_id</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">        INNER JOIN urgence u ON u.urgence_id = t.urgence_id</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        INNER JOIN user us ON us.username = t.username</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        INNER JOIN type ty ON ty.type_id = t.type_id</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        WHERE s.statut_id = 1 AND  p.produit_id = :produit_id </span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">        ORDER BY t.ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  332</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  333</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:produit_id&#39;</span> =&gt; $produit_id]);</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  335</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a45aa3d4d4c826cc295ac0848d76f433b" name="a45aa3d4d4c826cc295ac0848d76f433b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45aa3d4d4c826cc295ac0848d76f433b">&#9670;&#160;</a></span>getAllSolvedTickets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getAllSolvedTickets </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$produit_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00343">343</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  344</span>    {</div>
<div class="line"><span class="lineno">  345</span>        $query = <span class="stringliteral">&quot;SELECT t.ticket_id, t.titre, DATE_FORMAT(t.date_creation, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_creation, s.valeur, p.nom_produit, ty.nom_type, u.niveau, us.username FROM ticket t</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">        INNER JOIN statut s ON s.statut_id = t.statut_id</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">        INNER JOIN urgence u ON u.urgence_id = t.urgence_id</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">        INNER JOIN user us ON us.username = t.username</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">        INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">        INNER JOIN type ty ON ty.type_id = t.type_id</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">        WHERE s.statut_id = 2 AND  p.produit_id = :produit_id</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">        ORDER BY t.ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  353</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  354</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:produit_id&#39;</span> =&gt; $produit_id]);</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  356</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a17e1a3b63fb4dc2dd6e4c2f62f63ccee" name="a17e1a3b63fb4dc2dd6e4c2f62f63ccee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e1a3b63fb4dc2dd6e4c2f62f63ccee">&#9670;&#160;</a></span>getAllTicketMessages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getAllTicketMessages </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00528">528</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  528</span>                                                                {</div>
<div class="line"><span class="lineno">  529</span>        $query = $this-&gt;db-&gt;prepare(<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">            SELECT message_sent, message_sender, message_receiver, date_sent </span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">            FROM chat_messages </span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">            WHERE ticket_id = :ticket_id AND (message_sender = :username OR message_receiver = :username)</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">            ORDER BY date_sent ASC</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">        &#39;</span>);</div>
<div class="line"><span class="lineno">  535</span>        $query-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id, PDO::PARAM_INT);</div>
<div class="line"><span class="lineno">  536</span>        $query-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username, PDO::PARAM_STR);</div>
<div class="line"><span class="lineno">  537</span>        $query-&gt;execute();</div>
<div class="line"><span class="lineno">  538</span>    </div>
<div class="line"><span class="lineno">  539</span>        <span class="keywordflow">return</span> $query-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  540</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a93f358a3ea6c7bdac1fc362b2e0abd88" name="a93f358a3ea6c7bdac1fc362b2e0abd88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93f358a3ea6c7bdac1fc362b2e0abd88">&#9670;&#160;</a></span>getAttachmentsTicket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getAttachmentsTicket </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00386">386</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  387</span>    {</div>
<div class="line"><span class="lineno">  388</span>        $query = <span class="stringliteral">&quot;SELECT * FROM attachments WHERE ticket_id=:ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  389</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  390</span>        $stmt-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id);</div>
<div class="line"><span class="lineno">  391</span>        $stmt-&gt;execute();</div>
<div class="line"><span class="lineno">  392</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  393</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adb9e6e43abdf48d4575a7fbc2a3e5412" name="adb9e6e43abdf48d4575a7fbc2a3e5412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb9e6e43abdf48d4575a7fbc2a3e5412">&#9670;&#160;</a></span>getClosedDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getClosedDetails </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00457">457</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  458</span>    {</div>
<div class="line"><span class="lineno">  459</span>        $query = <span class="stringliteral">&quot;SELECT t.ticket_id, t.titre, t.description, DATE_FORMAT(t.date_creation, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_creation, s.valeur, p.nom_produit, ty.nom_type, u.niveau, us.username FROM ticket t</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">        INNER JOIN statut s ON s.statut_id = t.statut_id</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral">        INNER JOIN urgence u ON u.urgence_id = t.urgence_id</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">        INNER JOIN user us ON us.username = t.username</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">        INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral">        INNER JOIN type ty ON ty.type_id = t.type_id</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">        WHERE s.statut_id = 3 AND t.ticket_id = :ticket_id</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">        ORDER BY t.date_creation DESC&quot;</span>;</div>
<div class="line"><span class="lineno">  467</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  468</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:ticket_id&#39;</span> =&gt; $ticket_id]);</div>
<div class="line"><span class="lineno">  469</span>        $result = $stmt-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  470</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno">  471</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6715babb8accb268587092ce1927649" name="ae6715babb8accb268587092ce1927649"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6715babb8accb268587092ce1927649">&#9670;&#160;</a></span>getProduit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getProduit </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00513">513</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  514</span>    {</div>
<div class="line"><span class="lineno">  515</span>        $query = <span class="stringliteral">&quot;SELECT * FROM produit&quot;</span>;</div>
<div class="line"><span class="lineno">  516</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  517</span>        $stmt-&gt;execute();</div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  519</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e14ed0dd4d0672824840ab0f7188c9d" name="a1e14ed0dd4d0672824840ab0f7188c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e14ed0dd4d0672824840ab0f7188c9d">&#9670;&#160;</a></span>getProduitsByUser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getProduitsByUser </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00683">683</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  684</span>    {</div>
<div class="line"><span class="lineno">  685</span>        $query = <span class="stringliteral">&quot;SELECT p.* FROM produit p INNER JOIN user_produit up ON p.produit_id = up.produit_id WHERE up.username = :username&quot;</span>;</div>
<div class="line"><span class="lineno">  686</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  687</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:username&#39;</span> =&gt; $username]);</div>
<div class="line"><span class="lineno">  688</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  689</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fdbf5b91a654a26d187428af65e6f63" name="a1fdbf5b91a654a26d187428af65e6f63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fdbf5b91a654a26d187428af65e6f63">&#9670;&#160;</a></span>getSolvedDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getSolvedDetails </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00479">479</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  480</span>    {</div>
<div class="line"><span class="lineno">  481</span>        $query = <span class="stringliteral">&quot;SELECT t.ticket_id, t.titre, t.description, DATE_FORMAT(t.date_creation, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_creation, s.valeur, p.nom_produit, ty.nom_type, u.niveau, us.username FROM ticket t</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">        INNER JOIN statut s ON s.statut_id = t.statut_id</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">        INNER JOIN urgence u ON u.urgence_id = t.urgence_id</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">        INNER JOIN user us ON us.username = t.username</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">        INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">        INNER JOIN type ty ON ty.type_id = t.type_id</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">        WHERE s.statut_id = 2 AND t.ticket_id = :ticket_id</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">        ORDER BY t.date_creation DESC&quot;</span>;</div>
<div class="line"><span class="lineno">  489</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  490</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:ticket_id&#39;</span> =&gt; $ticket_id]);</div>
<div class="line"><span class="lineno">  491</span>        $result = $stmt-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  492</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno">  493</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad281715b03529e0022eb36116ef40573" name="ad281715b03529e0022eb36116ef40573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad281715b03529e0022eb36116ef40573">&#9670;&#160;</a></span>getTicketDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getTicketDetails </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00401">401</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span>        $query = <span class="stringliteral">&quot;SELECT t.ticket_id, t.titre, t.description, DATE_FORMAT(t.date_creation, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_creation, s.valeur, p.nom_produit, ty.nom_type, u.niveau, us.username </span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">            FROM ticket t</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">            INNER JOIN statut s ON s.statut_id = t.statut_id</span></div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral">            INNER JOIN urgence u ON u.urgence_id = t.urgence_id</span></div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral">            INNER JOIN user us ON us.username = t.username</span></div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral">            INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral">            INNER JOIN type ty ON ty.type_id = t.type_id</span></div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">            WHERE t.statut_id = 1 AND t.ticket_id = :ticket_id</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">            ORDER BY t.date_creation DESC&quot;</span>;</div>
<div class="line"><span class="lineno">  412</span>        </div>
<div class="line"><span class="lineno">  413</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  414</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:ticket_id&#39;</span> =&gt; $ticket_id]);</div>
<div class="line"><span class="lineno">  415</span>        $result = $stmt-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  416</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno">  417</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a82e08984cf490ae1a9f5d7f6a73c8676" name="a82e08984cf490ae1a9f5d7f6a73c8676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e08984cf490ae1a9f5d7f6a73c8676">&#9670;&#160;</a></span>getTicketEventHistory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getTicketEventHistory </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00301">301</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  302</span>    {</div>
<div class="line"><span class="lineno">  303</span>        $query = <span class="stringliteral">&quot;SELECT e.evenement_id, e.ticket_id, DATE_FORMAT(e.date_evenement, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_evenement, e.username, se.event_type, e.titre, p.nom_produit, e.description, t.statut_id </span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">                FROM evenement e</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">                INNER JOIN statut_evenement se ON e.statut_evenement_id = se.statut_evenement_id</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">                INNER JOIN ticket t ON e.ticket_id = t.ticket_id</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">                INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">                WHERE e.ticket_id = :ticket_id</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">                ORDER BY e.date_evenement DESC&quot;</span>;</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  312</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:ticket_id&#39;</span> =&gt; $ticket_id]);</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  314</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad868ab9678c691322094bd2f9e5a1965" name="ad868ab9678c691322094bd2f9e5a1965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad868ab9678c691322094bd2f9e5a1965">&#9670;&#160;</a></span>getTicketSaveDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getTicketSaveDetails </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00425">425</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  426</span>    {</div>
<div class="line"><span class="lineno">  427</span>        $query = <span class="stringliteral">&quot;SELECT t.ticket_id, t.titre, t.description, DATE_FORMAT(t.date_creation, &#39;%d/%m/%Y %H:%i:%s&#39;) as date_creation, </span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">                s.valeur, p.nom_produit, ty.nom_type, u.niveau, us.username</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">            FROM ticket_save t</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">            INNER JOIN statut s ON s.statut_id = t.statut_id</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">            INNER JOIN urgence u ON u.urgence_id = t.urgence_id</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">            INNER JOIN user us ON us.username = t.username</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">            INNER JOIN produit p ON p.produit_id = t.produit_id</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">            INNER JOIN type ty ON ty.type_id = t.type_id</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">            WHERE t.ticket_save_id = (</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">                SELECT MAX(t2.ticket_save_id)</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">                FROM ticket_save t2</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">                WHERE t2.ticket_id = t.ticket_id</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">                AND t2.ticket_save_id &lt; (</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">                    SELECT MAX(t3.ticket_save_id)</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">                    FROM ticket_save t3</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">                    WHERE t3.ticket_id = t.ticket_id</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">                )</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">            ) AND t.ticket_id = :ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  445</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  446</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:ticket_id&#39;</span> =&gt; $ticket_id]);</div>
<div class="line"><span class="lineno">  447</span>        $result = $stmt-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordflow">return</span> $result ?: []; <span class="comment">// Retourne un tableau vide si aucun résultat</span></div>
<div class="line"><span class="lineno">  449</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6e7e7ea7e913a0f9f85e7b0ea68aff4" name="ac6e7e7ea7e913a0f9f85e7b0ea68aff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e7e7ea7e913a0f9f85e7b0ea68aff4">&#9670;&#160;</a></span>getUserByUsername()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getUserByUsername </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00643">643</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  644</span>    {</div>
<div class="line"><span class="lineno">  645</span>        $query = <span class="stringliteral">&quot;SELECT u.username, u.mail, u.entreprise, u.pwd ,u.role FROM user u </span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">         WHERE username=:username&quot;</span>;</div>
<div class="line"><span class="lineno">  647</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  648</span>        $stmt-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">  649</span>        $stmt-&gt;execute();</div>
<div class="line"><span class="lineno">  650</span>        <span class="keywordflow">return</span> $stmt-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  651</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aded5ff5d0e12ebd38ce7f4ccac73f903" name="aded5ff5d0e12ebd38ce7f4ccac73f903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded5ff5d0e12ebd38ce7f4ccac73f903">&#9670;&#160;</a></span>getUserMail()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getUserMail </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00697">697</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  698</span>    {</div>
<div class="line"><span class="lineno">  699</span>        $query = <span class="stringliteral">&quot;SELECT mail FROM user WHERE username = :username&quot;</span>;</div>
<div class="line"><span class="lineno">  700</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  701</span>        $stmt-&gt;execute([<span class="stringliteral">&#39;:username&#39;</span> =&gt; $username]);</div>
<div class="line"><span class="lineno">  702</span>        $userData = $stmt-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  703</span>        </div>
<div class="line"><span class="lineno">  704</span>        <span class="keywordflow">if</span> ($userData &amp;&amp; isset($userData[<span class="stringliteral">&#39;mail&#39;</span>])) {</div>
<div class="line"><span class="lineno">  705</span>            <span class="keywordflow">return</span> $userData[<span class="stringliteral">&#39;mail&#39;</span>]; <span class="comment">//Récupération du mail en chaîne de caract plutôt qu&#39;en tableau</span></div>
<div class="line"><span class="lineno">  706</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  707</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>; </div>
<div class="line"><span class="lineno">  708</span>        }</div>
<div class="line"><span class="lineno">  709</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20581b515b9f9499e3d000591ce011a1" name="a20581b515b9f9499e3d000591ce011a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20581b515b9f9499e3d000591ce011a1">&#9670;&#160;</a></span>getUsers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::getUsers </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00500">500</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  501</span>    {</div>
<div class="line"><span class="lineno">  502</span>        $query = <span class="stringliteral">&quot;SELECT * FROM user&quot;</span>;</div>
<div class="line"><span class="lineno">  503</span>        $stmt = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  504</span>        $stmt-&gt;execute();</div>
<div class="line"><span class="lineno">  505</span>        <span class="keywordflow">return</span> $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  506</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac84051a3ee1baac9e884ec0da3b3406b" name="ac84051a3ee1baac9e884ec0da3b3406b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac84051a3ee1baac9e884ec0da3b3406b">&#9670;&#160;</a></span>isUsernameExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::isUsernameExists </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00100">100</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  101</span>    {</div>
<div class="line"><span class="lineno">  102</span>        $query = <span class="stringliteral">&quot;SELECT COUNT(*) FROM user WHERE username = :username&quot;</span>;</div>
<div class="line"><span class="lineno">  103</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  104</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">  105</span>        $statement-&gt;execute();</div>
<div class="line"><span class="lineno">  106</span>        $count = $statement-&gt;fetchColumn();</div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">return</span> $count &gt; 0;</div>
<div class="line"><span class="lineno">  108</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adb692dfbea0cc49a0177dc7f5763f7c4" name="adb692dfbea0cc49a0177dc7f5763f7c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb692dfbea0cc49a0177dc7f5763f7c4">&#9670;&#160;</a></span>logEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::logEvent </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$statut_evenement_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00118">118</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  119</span>    {</div>
<div class="line"><span class="lineno">  120</span>        date_default_timezone_set(<span class="stringliteral">&#39;Europe/Paris&#39;</span>);</div>
<div class="line"><span class="lineno">  121</span>        <span class="comment">// Récupérer le titre, la description et le produit_id du ticket</span></div>
<div class="line"><span class="lineno">  122</span>        $query = <span class="stringliteral">&quot;SELECT titre, description, produit_id, date_creation, statut_id, urgence_id, username, type_id FROM ticket WHERE ticket_id = :ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  123</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  124</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id);</div>
<div class="line"><span class="lineno">  125</span>        $statement-&gt;execute();</div>
<div class="line"><span class="lineno">  126</span>        $ticket = $statement-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">if</span> (!$ticket) {</div>
<div class="line"><span class="lineno">  129</span>            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Ticket not found.&#39;</span>);</div>
<div class="line"><span class="lineno">  130</span>        }</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>        <span class="comment">// Préparer les données pour l&#39;insertion dans la table evenement</span></div>
<div class="line"><span class="lineno">  133</span>        $titre = $ticket[<span class="stringliteral">&#39;titre&#39;</span>];</div>
<div class="line"><span class="lineno">  134</span>        $description = $ticket[<span class="stringliteral">&#39;description&#39;</span>];</div>
<div class="line"><span class="lineno">  135</span>        $produit_id = $ticket[<span class="stringliteral">&#39;produit_id&#39;</span>];</div>
<div class="line"><span class="lineno">  136</span>        $date_evenement = date(<span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span>); <span class="comment">// Utiliser la date et l&#39;heure actuelles</span></div>
<div class="line"><span class="lineno">  137</span>        $date_creation = $ticket[<span class="stringliteral">&#39;date_creation&#39;</span>];</div>
<div class="line"><span class="lineno">  138</span>        $statut_id = $ticket[<span class="stringliteral">&#39;statut_id&#39;</span>];</div>
<div class="line"><span class="lineno">  139</span>        $urgence_id = $ticket[<span class="stringliteral">&#39;urgence_id&#39;</span>];</div>
<div class="line"><span class="lineno">  140</span>        $type_id = $ticket[<span class="stringliteral">&#39;type_id&#39;</span>];</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>        <span class="comment">// Insérer les données dans la table evenement</span></div>
<div class="line"><span class="lineno">  143</span>        $query = <span class="stringliteral">&quot;INSERT INTO evenement (ticket_id, username, date_evenement, statut_evenement_id, titre, description, produit_id) </span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">                VALUES (:ticket_id, :username, :date_evenement, :statut_evenement_id, :titre, :description, :produit_id)&quot;</span>;</div>
<div class="line"><span class="lineno">  145</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  146</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id);</div>
<div class="line"><span class="lineno">  147</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">  148</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:date_evenement&#39;</span>, $date_evenement);</div>
<div class="line"><span class="lineno">  149</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:statut_evenement_id&#39;</span>, $statut_evenement_id);</div>
<div class="line"><span class="lineno">  150</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:titre&#39;</span>, $titre);</div>
<div class="line"><span class="lineno">  151</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:description&#39;</span>, $description);</div>
<div class="line"><span class="lineno">  152</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:produit_id&#39;</span>, $produit_id);</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">if</span> (!$statement-&gt;execute()) {</div>
<div class="line"><span class="lineno">  155</span>            error_log(<span class="stringliteral">&quot;Failed to log event: &quot;</span> . $query);</div>
<div class="line"><span class="lineno">  156</span>            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Failed to log event.&#39;</span>);</div>
<div class="line"><span class="lineno">  157</span>        }</div>
<div class="line"><span class="lineno">  158</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2e0958674a1084a1a6922fa7b2cf88c" name="ac2e0958674a1084a1a6922fa7b2cf88c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2e0958674a1084a1a6922fa7b2cf88c">&#9670;&#160;</a></span>sendMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::sendMessage </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00550">550</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  550</span>                                                                 {</div>
<div class="line"><span class="lineno">  551</span>        date_default_timezone_set(<span class="stringliteral">&#39;Europe/Paris&#39;</span>);</div>
<div class="line"><span class="lineno">  552</span>        $date_sent = date(<span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span>);</div>
<div class="line"><span class="lineno">  553</span>    </div>
<div class="line"><span class="lineno">  554</span>        <span class="comment">// Récupérer le créateur du ticket</span></div>
<div class="line"><span class="lineno">  555</span>        $query = $this-&gt;db-&gt;prepare(<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">            SELECT username </span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">            FROM ticket </span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">            WHERE ticket_id = :ticket_id</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">        &#39;</span>);</div>
<div class="line"><span class="lineno">  560</span>        $query-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id, PDO::PARAM_INT);</div>
<div class="line"><span class="lineno">  561</span>        $query-&gt;execute();</div>
<div class="line"><span class="lineno">  562</span>        $ticket = $query-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  563</span>        </div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">if</span> (!$ticket) {</div>
<div class="line"><span class="lineno">  565</span>            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Ticket not found&quot;</span>);</div>
<div class="line"><span class="lineno">  566</span>        }</div>
<div class="line"><span class="lineno">  567</span>    </div>
<div class="line"><span class="lineno">  568</span>        $receiver = $ticket[<span class="stringliteral">&#39;username&#39;</span>];</div>
<div class="line"><span class="lineno">  569</span>    </div>
<div class="line"><span class="lineno">  570</span>        <span class="comment">// Insérer le message dans la table chat_message</span></div>
<div class="line"><span class="lineno">  571</span>        $insertQuery = $this-&gt;db-&gt;prepare(<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">            INSERT INTO chat_messages (message_sender, message_receiver, message_sent, date_sent, ticket_id) </span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">            VALUES (:message_sender, :message_receiver, :message_sent, :date_sent, :ticket_id)</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">        &#39;</span>);</div>
<div class="line"><span class="lineno">  575</span>        $insertQuery-&gt;bindValue(<span class="stringliteral">&#39;:message_sender&#39;</span>, $username, PDO::PARAM_STR);</div>
<div class="line"><span class="lineno">  576</span>        $insertQuery-&gt;bindValue(<span class="stringliteral">&#39;:message_receiver&#39;</span>, $receiver, PDO::PARAM_STR);</div>
<div class="line"><span class="lineno">  577</span>        $insertQuery-&gt;bindValue(<span class="stringliteral">&#39;:message_sent&#39;</span>, $message, PDO::PARAM_STR);</div>
<div class="line"><span class="lineno">  578</span>        $insertQuery-&gt;bindValue(<span class="stringliteral">&#39;:date_sent&#39;</span>, $date_sent, PDO::PARAM_STR);</div>
<div class="line"><span class="lineno">  579</span>        $insertQuery-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id, PDO::PARAM_INT);</div>
<div class="line"><span class="lineno">  580</span>        $insertQuery-&gt;execute();</div>
<div class="line"><span class="lineno">  581</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5775e2b900e95eae8f702307cffb2bbb" name="a5775e2b900e95eae8f702307cffb2bbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5775e2b900e95eae8f702307cffb2bbb">&#9670;&#160;</a></span>updateTicketsDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::updateTicketsDetails </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ticket_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newTitle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newDescription</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00591">591</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  592</span>    {</div>
<div class="line"><span class="lineno">  593</span>        date_default_timezone_set(<span class="stringliteral">&#39;Europe/Paris&#39;</span>);</div>
<div class="line"><span class="lineno">  594</span>        $date_creation = date(<span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span>);</div>
<div class="line"><span class="lineno">  595</span>        $username = $_SESSION[<span class="stringliteral">&#39;username&#39;</span>];</div>
<div class="line"><span class="lineno">  596</span>        <span class="comment">// Récupérer l&#39;état actuel du ticket</span></div>
<div class="line"><span class="lineno">  597</span>        $query = <span class="stringliteral">&quot;SELECT * FROM ticket WHERE ticket_id = :ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  598</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  599</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id);</div>
<div class="line"><span class="lineno">  600</span>        $statement-&gt;execute();</div>
<div class="line"><span class="lineno">  601</span>        $ticket = $statement-&gt;fetch(PDO::FETCH_ASSOC);</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>        <span class="keywordflow">if</span> ($ticket) {</div>
<div class="line"><span class="lineno">  604</span>            <span class="comment">// Sauvegarder l&#39;état actuel du ticket dans ticket_save</span></div>
<div class="line"><span class="lineno">  605</span>            </div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>            <span class="comment">// Mettre à jour le ticket avec les nouvelles valeurs</span></div>
<div class="line"><span class="lineno">  608</span>            $query = <span class="stringliteral">&quot;UPDATE ticket SET titre = :newTitle, description = :newDescription WHERE ticket_id = :ticket_id&quot;</span>;</div>
<div class="line"><span class="lineno">  609</span>            $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  610</span>            $statement-&gt;bindValue(<span class="stringliteral">&#39;:ticket_id&#39;</span>, $ticket_id);</div>
<div class="line"><span class="lineno">  611</span>            $statement-&gt;bindValue(<span class="stringliteral">&#39;:newTitle&#39;</span>, $newTitle);</div>
<div class="line"><span class="lineno">  612</span>            $statement-&gt;bindValue(<span class="stringliteral">&#39;:newDescription&#39;</span>, $newDescription);</div>
<div class="line"><span class="lineno">  613</span>        </div>
<div class="line"><span class="lineno">  614</span>            $this-&gt;<a class="code hl_function" href="#a4a13082dbb4314461520699e6ad2d4a3">createTicketSave</a>(</div>
<div class="line"><span class="lineno">  615</span>                $ticket[<span class="stringliteral">&#39;ticket_id&#39;</span>],</div>
<div class="line"><span class="lineno">  616</span>                $newTitle,</div>
<div class="line"><span class="lineno">  617</span>                $newDescription,</div>
<div class="line"><span class="lineno">  618</span>                $date_creation,</div>
<div class="line"><span class="lineno">  619</span>                $ticket[<span class="stringliteral">&#39;statut_id&#39;</span>],</div>
<div class="line"><span class="lineno">  620</span>                $ticket[<span class="stringliteral">&#39;urgence_id&#39;</span>],</div>
<div class="line"><span class="lineno">  621</span>                $username,</div>
<div class="line"><span class="lineno">  622</span>                $ticket[<span class="stringliteral">&#39;produit_id&#39;</span>],</div>
<div class="line"><span class="lineno">  623</span>                $ticket[<span class="stringliteral">&#39;type_id&#39;</span>]</div>
<div class="line"><span class="lineno">  624</span>            );</div>
<div class="line"><span class="lineno">  625</span>            <span class="keywordflow">if</span> ($statement-&gt;execute()) {</div>
<div class="line"><span class="lineno">  626</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  627</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  628</span>                error_log(<span class="stringliteral">&quot;Failed to execute SQL query: &quot;</span> . $query);</div>
<div class="line"><span class="lineno">  629</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  630</span>            }</div>
<div class="line"><span class="lineno">  631</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  632</span>            error_log(<span class="stringliteral">&quot;Ticket with ID $ticket_id not found.&quot;</span>);</div>
<div class="line"><span class="lineno">  633</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  634</span>        }</div>
<div class="line"><span class="lineno">  635</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac66d28939888da0e528bcc66d5e43391" name="ac66d28939888da0e528bcc66d5e43391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac66d28939888da0e528bcc66d5e43391">&#9670;&#160;</a></span>updateUserPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::updateUserPassword </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$username</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newPassword</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00660">660</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  661</span>    {</div>
<div class="line"><span class="lineno">  662</span>        $hashedPassword = password_hash($newPassword, PASSWORD_DEFAULT);</div>
<div class="line"><span class="lineno">  663</span>    </div>
<div class="line"><span class="lineno">  664</span>        $query = <span class="stringliteral">&quot;UPDATE user SET pwd = :hashedPassword WHERE username = :username&quot;</span>;</div>
<div class="line"><span class="lineno">  665</span>        $statement = $this-&gt;db-&gt;prepare($query);</div>
<div class="line"><span class="lineno">  666</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:hashedPassword&#39;</span>, $hashedPassword);</div>
<div class="line"><span class="lineno">  667</span>        $statement-&gt;bindValue(<span class="stringliteral">&#39;:username&#39;</span>, $username);</div>
<div class="line"><span class="lineno">  668</span>    </div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">if</span> ($statement-&gt;execute()) {</div>
<div class="line"><span class="lineno">  670</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  671</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  672</span>            error_log(<span class="stringliteral">&quot;Failed to execute SQL query: &quot;</span> . $query);</div>
<div class="line"><span class="lineno">  673</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  674</span>        }</div>
<div class="line"><span class="lineno">  675</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Documentation des données membres</h2>
<a id="ab2f29f75e97371fd013eb3ff367a7d4c" name="ab2f29f75e97371fd013eb3ff367a7d4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2f29f75e97371fd013eb3ff367a7d4c">&#9670;&#160;</a></span>$db</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AdminModel::$db</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Objet PDO pour la connexion à la base de données. </p>

<p class="definition">Définition à la ligne <a class="el" href="_admin_model_8php_source.html#l00029">29</a> du fichier <a class="el" href="_admin_model_8php_source.html">AdminModel.php</a>.</p>

</div>
</div>
<hr/>La documentation de cette classe a été générée à partir du fichier suivant :<ul>
<li>app/src/Models/<a class="el" href="_admin_model_8php_source.html">AdminModel.php</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
